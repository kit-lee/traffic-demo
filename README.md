# 题目
设计一个流量计费系统

# 系统设计

### 数据采集
直接在访问API时发送消息，通过消息队列，实现计费计算的解耦。

### 数据传输
将采集到的流量数据发送到Kafka消息队列中，通过Kafka实现实时传输和计算处理
可以用KStream做很多流处理，实时统计计算结果（时间关系代码中还没有加入KStream）

### 数据存储
使用MongoDB存储用户的流量记录，MongoDB的文档型存储结构非常适合像流量记录这样的日志类型记录的存储

### 访问控制
常用的限流算法包括漏桶，令牌桶，时间窗，滑动时间窗等算法
这个例子实现了基于内存的时间窗和基于Redis实现的滑动时间窗算法
同时Redis也可以作为缓存，会将用户数据的限流配置存储在缓存中

